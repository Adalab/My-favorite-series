"use strict";const searchInput=document.querySelector(".form__input"),searchButton=document.querySelector(".button__input"),resultList=document.querySelector(".results__list"),urlFetch="http://api.tvmaze.com/search/shows?q=",defaultImage="https://via.placeholder.com/210x295/ffffff/666666/?text=TV",createTitle=(e,t)=>{const r=document.createElement(t),a=document.createTextNode(e);return r.appendChild(a),r},searchFunction=(e,t)=>{const r=e.name.toLowerCase(),a=t.toLowerCase(),o=e.image;if(r.includes(a)){const t=createTitle(e.name,"h2"),r=createImageFetch(o,e.id);r.appendChild(t),resultList.appendChild(r)}};function createImageFetch(e,t){const r=document.createElement("li");r.setAttribute("class","result__item"),r.setAttribute("id",t);const a=document.createElement("div");return a.setAttribute("class","results__image"),a.style.backgroundImage=null===e?`url(${defaultImage})`:`url(${e.medium})`,r.addEventListener("click",selectFavorite),r.appendChild(a),r}function searchSeries(){resultList.innerHTML="";const e=searchInput.value;fetch(`${urlFetch}${e}`).then(e=>e.json()).then(t=>{for(const r of t){const t=r.show;searchFunction(t,e)}})}searchButton.addEventListener("click",searchSeries);const favoriteList=document.querySelector(".favorite__list");let favoritesArray=[];const createImg=e=>{const t=document.createElement("li");t.setAttribute("class","favorite__item");const r=document.createElement("div");return r.setAttribute("class","favorite__img"),r.style.backgroundImage=e,t.appendChild(r),t},createElement=e=>{favoriteList.innerHTML="";for(let t=0;t<e.length;t++){const r=createImg(e[t].image),a=createTitle(e[t].title,"h3");r.appendChild(a),favoriteList.appendChild(r)}},setStorage=e=>{localStorage.removeItem("favorite"),localStorage.setItem("favorite",JSON.stringify(e))},getStorage=()=>JSON.parse(localStorage.getItem("favorite"));function storageOrNot(){const e=getStorage();null!==e&&(favoritesArray.push(...e),createElement(e))}function selectFavorite(e){const t=e.currentTarget;t.classList.toggle("favorite__show");const r=t.querySelector("h2").innerHTML,a=t.querySelector("div").style.backgroundImage,o=parseInt(t.getAttribute("id"));if(0===favoritesArray.length)favoritesArray.push({id:o,title:r,image:a});else{const e=favoritesArray.findIndex(function(e){return e.id===o});-1===e?favoritesArray.push({id:o,title:r,image:a}):favoritesArray.splice(e,1)}createElement(favoritesArray),setStorage(favoritesArray)}window.addEventListener("load",storageOrNot);